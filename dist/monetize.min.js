!function(){function e(){return s?s:(s=document.createElement("iframe"),s.setAttribute("style","width: 1px; height: 1px; position: absolute; top: -100px;"),document.body.appendChild(s),s.onerror=function(){p&&p({error:I})},s)}function n(e,n){var t=g+e;return n.q=Date.now(),n=n&&Object.keys(n).map(function(e){return e+"="+encodeURIComponent(n[e])}).join("&"),n?t+"?"+n:t}function t(t,o){p=function(e){p=void 0,o(e)};var i={immediate:!0,response_type:"token",client_id:t.applicationID,redirect_uri:t.redirectURL};y(function(){e().src=n("/authorize",i),clearTimeout(v),v=setTimeout(function(){p&&p({error:D})},b)})}function o(e,t){f=function(e){f=void 0,t(e)};var o={popup:!0,response_type:"token",client_id:e.applicationID,redirect_uri:e.redirectURL};e.pricingOptions&&e.pricingOptions.length&&(o.pricing_options=e.pricingOptions.join(",")),e.summary&&(o.summary=!0);var i={toolbar:"no",location:"no",directories:"no",status:"no",menubar:"no",scrollbars:"no",resizable:"no",copyhistory:"no",width:w,height:k,left:(screen.width-w)/2,top:(screen.height-k)/2};window.open(n("/authorize",o),void 0,Object.keys(i).map(function(e){return e+"="+i[e]}).join(","))}function i(){return d&&document.body.removeChild(d),d=document.createElement("script"),d.onerror=function(){m&&m({error:I})},document.body.appendChild(d),d}function r(e){m=function(n){m=void 0,e(n)};var t={access_token:l.token,callback:"_monetizeJsonpCallback"};y(function(){i().src=n("/api/payments",t),clearTimeout(h),h=setTimeout(function(){m&&m({error:D})},b)})}function c(e){var t={redirect:!0,response_type:"token",client_id:e.applicationID,redirect_uri:e.redirectURL};e.pricingOptions&&e.pricingOptions.length&&(t.pricing_options=e.pricingOptions.join(",")),e.summary&&(t.summary=!0),window.location=n("/authorize",t)}function u(e,n){for(var t in n)e[t]=n[t]}function a(e){function n(e){return function(n,t){"function"==typeof n&&(t=n,n={});var o={};u(o,i),u(o,n||{}),e(o,t)}}var i={};u(i,O),u(i,e||{});var a={};return a.getTokenImmediate=n(function(e,n){return l&&l.token&&l.refreshDate>Date.now()?n(void 0,l.token):void t(e,function(e){n(e.error,e.token)})}),a.getPaymentsImmediate=n(function(e,n){return l&&l.token&&l.refreshDate>Date.now()?r(function(e){n(e.error,e.payments)}):void t(e,function(e){n(e.error,e.payments)})}),a.getTokenInteractive=n(function(e,n){return n?void o(e,function(e){n(e.error,e.token)}):c(e)}),a.getPaymentsInteractive=n(function(e,n){return n?void o(e,function(e){n(e.error,e.payments)}):c(e)}),a}var s,d,p,f,m,l,v,h,y=function(){var e,n=[],t=/^loaded|c/.test(document.readyState),o="DOMContentLoaded";return document.addEventListener(o,e=function(){for(document.removeEventListener(o,e,!1),t=1;e=n.shift();)e()},!1),function(e){t?e():n.push(e)}}(),g="http://localhost:3000",w=1e3,k=700,b=3e4,_=3e5,D="Request timeout",I="Please check your JS console";window.addEventListener("message",function(e){e.origin==g&&(l=e.data,l.expiresIn&&(l.refreshDate=Date.now()+l.expiresIn-_),l.popup?f&&f(l):(clearTimeout(v),p&&p(l)))}),window._monetizeJsonpCallback=function(e){clearTimeout(h),m&&m({payments:e})};var O={redirectURL:window.location.href};window.MonetizeJS=a,"function"==typeof define&&define.amd&&define("MonetizeJS",[],function(){return a})}();